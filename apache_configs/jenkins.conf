<VirtualHost *:80>
    ServerName mohamedesmael.work.gd
    RewriteEngine On
    RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

<VirtualHost *:443>
    ServerName mohamedesmael.work.gd

    SSLCertificateFile      /etc/letsencrypt/live/mohamedesmael.work.gd/fullchain.pem
    SSLCertificateKeyFile   /etc/letsencrypt/live/mohamedesmael.work.gd/privkey.pem
    SSLCertificateFile      /etc/letsencrypt/live/mohamedesmael.work.gd-rsa/fullchain.pem
    SSLCertificateKeyFile   /etc/letsencrypt/live/mohamedesmael.work.gd-rsa/privkey.pem

    SSLEngine on
    SSLProtocol             all -SSLv3 -TLSv1 -TLSv1.1
    SSLHonorCipherOrder     on
    SSLCompression          off
    Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"

    ProxyPreserveHost On

    <Proxy "http://127.0.0.1:8080/">
        Require all granted
    </Proxy>

    ProxyPass        "/"  "http://127.0.0.1:8080/"  retry=0
    ProxyPassReverse "/"  "http://127.0.0.1:8080/"

    RequestHeader set    X-Forwarded-Proto "https"
    RequestHeader set    X-Real-IP          %{REMOTE_ADDR}e
    RequestHeader append X-Forwarded-For    %{REMOTE_ADDR}e

    ErrorLog   /var/log/apache2/jenkins.error.log
    CustomLog  /var/log/apache2/jenkins.access.log combined
</VirtualHost>

